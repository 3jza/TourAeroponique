# Configuration Nginx pour la Tour Aéroponique
# Ce fichier est un exemple de configuration
# À placer dans /etc/nginx/sites-available/aeroponic (ou modifier default)

server {
    # Port d'écoute (80 pour HTTP, 443 pour HTTPS)
    listen 80;
    
    # Nom du serveur (remplacer par l'IP du Raspberry Pi si besoin)
    server_name localhost;
    
    # Répertoire racine des fichiers web
    root /var/www/html;
    
    # Fichier index par défaut
    index index.html;
    
    # Configuration des logs
    access_log /var/log/nginx/aeroponic_access.log;
    error_log /var/log/nginx/aeroponic_error.log;
    
    # Configuration principale
    location / {
        # Essayer de servir le fichier demandé, sinon index.html
        try_files $uri $uri/ /index.html;
    }
    
    # Configuration spécifique pour le fichier JSON
    location /data.json {
        # Autoriser les requêtes depuis n'importe quelle origine (pour le développement)
        add_header Access-Control-Allow-Origin *;
        
        # Type MIME pour JSON
        add_header Content-Type application/json;
        
        # Désactiver le cache pour le fichier JSON (mise à jour fréquente)
        add_header Cache-Control "no-cache, no-store, must-revalidate";
        add_header Pragma "no-cache";
        add_header Expires "0";
    }
    
    # Configuration pour les fichiers statiques (CSS, JS, images)
    location ~* \.(css|js|jpg|jpeg|png|gif|ico|svg)$ {
        # Cache pour les fichiers statiques (1 heure)
        expires 1h;
        add_header Cache-Control "public, immutable";
    }
    
    # Gestion des erreurs 404
    error_page 404 /index.html;
}

